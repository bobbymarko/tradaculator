var loading=true;$(function(){var c="Call of Duty",b=1,a=$(window),d=$("#product_list");get_games(c,1);$("form").submit(function(f){c=$("input",this).val();b=1;$("#product_list").html("");get_games(c,b);f.preventDefault()});a.scroll(function(){if((a.scrollTop()+a.height())>(d.height()+d.offset().top)&&!loading){b++;get_games(c,b);loading=true}});$(".trade_in_value").live("click",function(f){$(this).closest(".hproduct").toggleClass("active").siblings().removeClass("active");f.preventDefault()})});function get_games(b,a){$("h3").remove();$("#product_list").after('<h3 id="loading">&#x203B;</h3>');$.ajax({url:"http://tradaculator.com/values/"+b+"/"+a,dataType:"jsonp",cache:true,success:function(d){$("#loading").remove();var c="";$.each(d,function(f,e){var g=[];$.each(e.tradeInValue,function(i,h){if(h.value){h.vendor=i;g.push(h)}});g.sort(function(i,h){return parseInt(h.value.replace(/[\$\.]/g,""),10)-parseInt(i.value.replace(/[\$\.]/g,""),10)});if(e.tradeInValue){c+='<article class="hproduct">';c+='<div class="prod_wrap">';c+="<figure>";c+='<img src="'+e.image+'" alt="" />';c+="</figure>";c+="<header>";c+="<h1>"+e.name.split(" - ")[0]+"</h1>";c+="<p>"+e.name.split(" - ")[1]+"</p>";c+="</header>";c+='<div class="price_block_wrapper"><div class="price_block button"><a class="vendor_name" target="_blank" href="'+g[0].url+'">Trade It In</a><a href="#" class="trade_in_value">'+g[0].value+"</a></div>";c+='<ul class="drop_down">';$.each(g,function(i,h){c+='<li><a target="_blank" href="'+h.url+'">'+h.vendor.replace("_"," ")+" <span>"+h.value+"</span></a></li>"});c+="</ul>";c+="</div></div>";c+="</article>"}});if(c!==""){$("#product_list").append(c);loading=false}else{$("#product_list").after("<h3>That's all there is.</h3>");loading=true}}})};